--INSERT#

--INSERT INTO KLIENT (PESEL, IMIE_NAZWISKO, ADRES_ZAMIESZKANIA, NR_TEL) VALUES ('96111202345','Darek Marek', 'Birmo al. Korfantego 12','541548784');

--CREATE SEQUENCE myseq START WITH 11 INCREMENT by 1;

--INSERT INTO DOSTAWCA (ID_DOSTAWCY, NAZWA_DOSTAWCY, ADRES_DOSTAWCY) VALUES (myseq.NEXTVAL, 'BOROWIAK', 'Łęka ul. niema 12');

--UPDATE

--UPDATE ZAMÓWIENIE
--SET KONTO_EMAIL = 'k.falinski@gmail.com'
--WHERE ID_ZAMÓWIENIA = '20';

--UPDATE Z PODZAPYTANIEM I ZŁĄCZENIEM

--UPDATE KLIENT
--SET NR_TEL ='514457841'
--WHERE IMIE_NAZWISKO IN (SELECT L.IMIE_NAZWISKO
			--FROM KONTO K, KLIENT L
			--WHERE K.KLIENT_PESEL = L.PESEL AND K.KLIENT_PESEL = '96051558459' );

--SELECT 1#

SELECT DOSTAWCA_ID_DOSTAWCY, SUM(ŁĄCZNA_KWOTA) AS SUMA
FROM ZAMÓWIENIE
GROUP BY DOSTAWCA_ID_DOSTAWCY
ORDER BY SUMA DESC;


--SELECT 2#

SELECT COUNT(IMIE_NAZWISKO)AS URODZONYCH_W_98_ROKU
FROM KLIENT
WHERE PESEL LIKE '98%';

--SELECT 3#

SELECT MIN(ŁĄCZNA_KWOTA)AS NAJTAŃSZE_ZAMÓWNIENIE, MAX(ŁĄCZNA_KWOTA)AS NAJDROŻSZE_ZAMÓWNIENIE FROM ZAMÓWIENIE;

--SELECT 4#

SELECT ZAMÓWIENIE_ID_ZAMÓWIENIA "ID ZAMÓWIENIA", COUNT(ZAMÓWIENIE_ID_ZAMÓWIENIA) AS "ILOŚĆ PRODUKTÓW W ZAMÓWIENIU"
FROM EGZEMPLARZ 
GROUP BY ZAMÓWIENIE_ID_ZAMÓWIENIA 
HAVING ZAMÓWIENIE_ID_ZAMÓWIENIA > '3' AND  ZAMÓWIENIE_ID_ZAMÓWIENIA < '11'
ORDER BY ZAMÓWIENIE_ID_ZAMÓWIENIA ;


--SELECT 5#

SELECT ID_EGZEMPLARZA, NAZWA_PROD "PRODUKT"
FROM EGZEMPLARZ E INNER JOIN PRODUKT P ON E.PRODUKT_ID_PRODUKTU = P.ID_PRODUKTU
WHERE E.ZAMÓWIENIE_ID_ZAMÓWIENIA IS NULL
ORDER BY E.ID_EGZEMPLARZA;


--SELECT 6#

SELECT Z.ADRES_ZAMÓWIENIA, Z.ŁĄCZNA_KWOTA, K.EMAIL, L.IMIE_NAZWISKO
FROM KONTO K, ZAMÓWIENIE Z, KLIENT L
WHERE K.EMAIL = Z.KONTO_EMAIL AND K.KLIENT_PESEL = L.PESEL 
ORDER BY Z.ID_ZAMÓWIENIA;

--SELECT 7#

SELECT L.IMIE_NAZWISKO, Z.ŁĄCZNA_KWOTA
FROM ZAMÓWIENIE Z, KONTO K, KLIENT L
WHERE K.EMAIL = Z.KONTO_EMAIL AND K.KLIENT_PESEL = L.PESEL AND Z.ŁĄCZNA_KWOTA > (SELECT AVG(ŁĄCZNA_KWOTA) FROM ZAMÓWIENIE);

--SELECT 8#

SELECT KATEGORIA,NAZWA_PROD ,CENA_JEDNOSTKOWA 
FROM PRODUKT 
WHERE CENA_JEDNOSTKOWA=(SELECT MIN(CENA_JEDNOSTKOWA) 
FROM PRODUKT WHERE KATEGORIA = 'Karta graficzna' OR KATEGORIA LIKE 'P%');

--SELECT 9#

SELECT NAZWA_PROD, CENA_JEDNOSTKOWA CENA, KATEGORIA
FROM PRODUKT
WHERE CENA_JEDNOSTKOWA>1000 AND CENA_JEDNOSTKOWA<3000
ORDER BY KATEGORIA, CENA_JEDNOSTKOWA;


--SELECT 10#

SELECT IMIE_NAZWISKO, ADRES_ZAMIESZKANIA, NR_TEL
FROM KLIENT
WHERE IMIE_NAZWISKO LIKE 'Janusz%';

--SELECT 11#

SELECT NAZWA_PROD, CENA_JEDNOSTKOWA
FROM PRODUKT
WHERE NAZWA_PROD LIKE 'MSI%' AND KATEGORIA LIKE 'Płyta główna'
ORDER BY CENA_JEDNOSTKOWA;

--SELECT 12#

SELECT Z.DATA_ZAMÓWIENIA, K.EMAIL, L.PESEL, L.IMIE_NAZWISKO, L.ADRES_ZAMIESZKANIA
FROM ZAMÓWIENIE Z, KONTO K, KLIENT L
WHERE  K.EMAIL = Z.KONTO_EMAIL AND K.KLIENT_PESEL = L.PESEL  AND DATA_ZAMÓWIENIA >= '25/05/18'
ORDER BY DATA_ZAMÓWIENIA;

--SELECT 13#

SELECT KATEGORIA, MIN(CENA_JEDNOSTKOWA), MAX(CENA_JEDNOSTKOWA), ROUND(AVG(CENA_JEDNOSTKOWA),2)
FROM PRODUKT
GROUP BY KATEGORIA;

--SELECT 14#

SELECT NAZWA_DOSTAWCY, COUNT(ID_DOSTAWCY) AS ILE_DOSTAWCÓW
FROM DOSTAWCA  
WHERE ADRES_DOSTAWCY LIKE 'Warszawa%'
GROUP BY NAZWA_DOSTAWCY;

--SELECT 15#

SELECT ID_PRODUKTU, COUNT(ID_PRODUKTU) 
FROM PRODUKT 
GROUP BY ID_PRODUKTU HAVING COUNT(ID_PRODUKTU)>1;





